Here is a comprehensive, Wiki-style **README.md** file. You can copy this directly into your GitHub repository.

***

# Weekly Performance Tracker

A robust, full-stack application designed to track, monitor, and analyze the weekly performance of video editors. Built with **Next.js**, **Supabase**, and **Tailwind CSS**.

This system replaces legacy Google Sheets/Forms with a secure, scalable, and user-friendly interface featuring role-based access control, complex data visualization, and automated profile management.

---

## ðŸ“š Table of Contents
1. [Tech Stack](#-tech-stack)
2. [Prerequisites](#-prerequisites)
3. [Project Structure](#-project-structure)
4. [Database Setup (Supabase)](#-database-setup-critical)
5. [Local Development](#-local-development)
6. [Deployment](#-deployment)
7. [User Guide: Editors](#-user-guide-editors)
8. [User Guide: Admins](#-user-guide-admins)
9. [Maintenance & FAQs](#-maintenance--faqs)

---

## ðŸ›  Tech Stack
*   **Frontend:** Next.js 16 (App Router), React, TypeScript.
*   **Styling:** Tailwind CSS, Lucide React (Icons).
*   **Backend & Auth:** Supabase (PostgreSQL).
*   **Hosting:** Vercel.

---

## ðŸ“‹ Prerequisites
To set this up from scratch, you need:
1.  **Node.js:** v18.17.0 or higher.
2.  **GitHub Account:** To host the code.
3.  **Vercel Account:** For deployment.
4.  **Supabase Account:** For the database and authentication.

---

## ðŸ“‚ Project Structure
Key files and folders you need to know about:

```bash
weekly-tracker/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ admin/              
â”‚   â”‚   â”œâ”€â”€ migrate/        # Tool to import legacy CSV data
â”‚   â”‚   â””â”€â”€ page.tsx        # The Main Admin Dashboard (Tracker + Data Sheet)
â”‚   â”œâ”€â”€ dashboard/
â”‚   â”‚   â””â”€â”€ page.tsx        # The Editor's Submission Form
â”‚   â”œâ”€â”€ success/            # "Thank you" page after submission
â”‚   â”œâ”€â”€ layout.tsx          # Main layout (Metadata/Tab Title)
â”‚   â””â”€â”€ page.tsx            # Login / Sign Up Page
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ supabase.ts         # Supabase client configuration
â”‚   â””â”€â”€ utils.ts            # Helper functions (Date calculations)
â”œâ”€â”€ public/                 # Static assets
â”œâ”€â”€ .env.local              # Environment variables (API Keys)
â””â”€â”€ middleware.ts           # (Optional) Auth session handling
```

---

## ðŸ—„ Database Setup (Critical)
This project relies on a specific Supabase schema. If you are setting this up again, run these SQL commands in the **Supabase SQL Editor**.

### 1. Create Tables
```sql
-- Profiles: Links Auth Users to Real Names
create table public.profiles (
  id uuid references auth.users on delete cascade not null primary key,
  email text unique not null,
  full_name text,
  yaas_id text,
  role text default 'editor' check (role in ('editor', 'admin')),
  created_at timestamp with time zone default timezone('utc'::text, now()) not null
);

-- Registry: The "Source of Truth" for allowed editors
create table public.editor_registry (
  yaas_id text primary key,
  name text not null,
  email text unique not null
);

-- IPs: List of Channels/Projects
create table public.ips (
  id bigint generated by default as identity primary key,
  name text unique not null,
  active boolean default true
);

-- Reports: The actual submissions (Single Table Architecture)
create table public.reports (
  id uuid default gen_random_uuid() primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  user_id uuid references auth.users, -- Nullable for legacy data
  editor_name text not null,
  editor_email text not null,
  yaas_id text not null,
  submission_date date not null,
  week_label text not null,
  month_label text not null,
  
  -- General Metrics
  hygiene_score numeric(3,1),
  mistakes_repeated boolean default false,
  mistake_details text,
  delays boolean default false,
  delay_reasons text,
  general_improvements text,
  next_week_commitment numeric,
  areas_improvement text,
  overall_feedback text,
  
  -- Complex Data (IPs) stored as JSON
  ip_data jsonb not null
);
```

### 2. Enable Security (RLS Policies)
```sql
alter table profiles enable row level security;
alter table reports enable row level security;
alter table editor_registry enable row level security;

-- Profiles
create policy "Public profiles are viewable by everyone" on profiles for select using (true);

-- Registry
create policy "Read registry" on editor_registry for select using (true);

-- Reports
create policy "Users see own reports" on reports for select using (auth.uid() = user_id);
create policy "Admins see all reports" on reports for select using (
  exists (select 1 from profiles where id = auth.uid() and role = 'admin')
);
create policy "Users insert own" on reports for insert with check (auth.uid() = user_id);
create policy "Admins insert any" on reports for insert with check (
  exists (select 1 from profiles where id = auth.uid() and role = 'admin')
);
```

### 3. Create Automation Trigger (Auto-Profile & Access Control)
This ensures only people in the `editor_registry` can sign up.

```sql
create or replace function public.handle_new_user() 
returns trigger as $$
declare
  registry_record record;
begin
  -- Check if email exists in Registry
  select * into registry_record from public.editor_registry where lower(email) = lower(new.email);
     
  if registry_record is null then
     raise exception 'Access Denied: Your email is not in the allowed Editors List.';
  end if;

  -- Auto-create profile with correct Name/ID
  insert into public.profiles (id, email, full_name, yaas_id)
  values (new.id, new.email, registry_record.name, registry_record.yaas_id);

  return new;
end;
$$ language plpgsql security definer;

create trigger on_auth_user_created
  after insert on auth.users
  for each row execute procedure public.handle_new_user();
```

---

## ðŸ’» Local Development

1.  **Clone the repo:**
    ```bash
    git clone https://github.com/YOUR_USERNAME/weekly-tracker.git
    cd weekly-tracker
    ```

2.  **Install dependencies:**
    ```bash
    npm install
    ```

3.  **Setup Environment:**
    Create a `.env.local` file in the root folder:
    ```env
    NEXT_PUBLIC_SUPABASE_URL=your_supabase_project_url
    NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
    ```

4.  **Run the server:**
    ```bash
    npm run dev
    ```
    Open `http://localhost:3000`.

---

## ðŸš€ Deployment

1.  Push your code to **GitHub**.
2.  Go to **Vercel** -> Add New Project -> Import from GitHub.
3.  **Environment Variables:** Add the same `NEXT_PUBLIC_SUPABASE_URL` and `KEY` from your local file into Vercel settings.
4.  **Root Directory:** Ensure it is set to the folder name (e.g., `weekly-tracker`) if your repo has nested folders.
5.  Click **Deploy**.

---

## ðŸ‘¤ User Guide: Editors

1.  **Sign Up:** Go to the URL. Click "Sign Up". Enter your work email and password.
    *   *Note:* You can only sign up if your email has been pre-approved by the Admin.
2.  **Dashboard:** Once logged in, your Name and YAAS ID are auto-filled.
3.  **Filling the Report:**
    *   **Section 1:** Fill general performance questions.
    *   **Section 2:** Click **"+ Add IP"** to add a tab for every Channel/IP you worked on.
    *   Fill delivery numbers and drive links.
4.  **Submit:** Click Submit. You will be redirected to a success page.

---

## ðŸ‘‘ User Guide: Admins

### 1. How to Access
Go to `https://your-site.vercel.app/admin`.
*(Note: You must have the 'admin' role, see below).*

### 2. Dashboard Features
*   **Tracker View:**
    *   See a grid of all editors.
    *   **Green:** Submitted for the selected week.
    *   **Red:** Missing submission.
    *   **Filter:** Show only "Missing" to follow up.
    *   **History:** Click on any editor's card to see their lifetime submission history.
*   **Data Sheet View:**
    *   Full Excel-style table.
    *   **Grouping:** Rows automatically merge by Editor Name for easier reading.
    *   **Filtering:** Type in column headers to filter (e.g., type "Licious" in IP Name to see only Licious work).
    *   **Sorting:** Click headers to sort.

### 3. Migrating Old Data
Go to `https://your-site.vercel.app/admin/migrate`.
1.  Open your old Excel/Google Sheet.
2.  Copy all cells (Ctrl+A, Ctrl+C).
3.  Paste into the text box.
4.  Click "Start Import".

---

## ðŸ”§ Maintenance & FAQs

### How to add a NEW Editor?
You must add them to the database before they can sign up.
1.  Go to Supabase -> Table Editor -> `editor_registry`.
2.  Click **Insert New Row**.
3.  Add their `yaas_id`, `name`, and `email`.
4.  Save. Now they can sign up.

### How to promote someone to Admin?
1.  Go to Supabase -> Table Editor -> `profiles`.
2.  Find the user.
3.  Change the `role` column from `editor` to `admin`.
4.  Save.

### How to add a new IP to the dropdown?
1.  Go to Supabase -> Table Editor -> `ips`.
2.  Insert a new row with the IP Name.
3.  Save. It will immediately appear in the form.

### The "Tracker" shows everyone as missing?
Check the **Date Picker** in the top right. It defaults to the current week. If you are looking for past data, change the date.
